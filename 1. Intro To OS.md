### Intro To OS

#### 操作系统定义

• 操作系统是一直运行在计算机上的程序

它是**资源管理（包括软件和硬件资源）**平台，**运行程序**的平台，也是为**用户提供服务**的平台

系统调用（也叫程序接口）是操作系统给编程人员提供的接口。

##### 启动

启动电源->主板->bios->引导程序

引导程序的工作内容包括：**1. 初始化设备 2. 把操作系统载入到内存中 3. 运行第一个进程 init(), 等待事件发生**

##### 中断

软中断：系统调用 (System Call) 会触发软件中断。不可屏蔽。

硬中断：硬件向cpu发送中断信号。可屏蔽。

**举例**：

**1.IO设备 2.异常事件（断电） 3.非法指令（除以0）**



#### IO结构

1. CPU负责内存与本地缓冲器之间的数据传递 

2. 设备控制器负责在其所控制的外部设备与本地缓冲存储之间进 行数据传递

3. I/O 操作结束后，设备控制器通过中断通知 CPU 表示 I/O 结束

   

I/O设备与CPU可同时运行

主机拥有多种**设备控制器**，设备控制器拥有：**本地缓冲器（buffer）和寄存器**

<img src="md_image\image-20220604162620657.png" alt="image-20220604162620657" style="zoom:67%;" />

##### 直接访问内存的IO：DMA

##### 同步、异步

同步：IO结束用户程序才能获得控制权

异步相反

##### 分类

**一级存储设备**：内存，是易失存储设备。

**二级存储设备**：一般不易失的存储设备。

#### 体系结构

##### 单处理器

##### 多处理器

###### <font color=red> 多处理器环境下，不管多处理器还是多核处理器、每个处理器都需要有自己的寄存器和高速缓存？</font>

因为不同线程都保存有自己的寄存器备份以及栈等内容，也就是说处理器的某个核心上各个寄存器的值来自于一个线程，在线程被切换出去时这些寄存器信息都会被保存回线程里，而被调入的线程所保存的寄存器信息将被载入

###### 对称处理器

处理器没有主从关系

###### 非对称处理器

cpu结构上不同，有主从关系

##### 集群系统：集群系统是一种由互相连接的计算机组成的并行分布式系统 ，共享存储

多个自治系统（统指的是各节点都有自己独立的操作系统）协同工作

**优点** 更快的处理速度，更大的存储容量，更好的数据完整性，更高的可靠性和更广泛的可用性资源（高性能）

**缺点** 高费用

非对称/对称集群

#### 操作系统的结构

##### 批处理

**操作员**进行任务调度

当发生 I/O 操作时，由操作员调度另一个程序运行， 从而提高CPU的使用率。

##### 多道程序系统&分时系统

多道系统目的：提高cpu效率，让cpu忙

分时系统目的：每个任务公平使用cpu（每个任务给定一个时间片）

<font color=red>现在的操作系统是批处理系统，还是多道程序系统，还是分时系统?</font>

unix linux windows都是分时

##### 两种操作模式：<font color=red>内核模式和用户模式（必须区分操作系统的代码和用户代码的执行，通过模式位来区分）</font>

#### 操作系统的管理

<font color=red>程序是被动实体，进程是活动实体</font>

##### 进程管理：进程是运行中的程序，是系统的运行单元

在一个系统中有无数个进程在同时运行，运行在一个或多个CPU 上，进程之间通过复用CPU并发运行

程序是**被动**实体，而进程是**活动**实体

##### 内存管理：目的是提高内存的使用率； 管理内存中的数据的存储、指令的运行

##### 存储管理：统一的逻辑信息存储观点，即文件系统

<font color=red>操作系统对存储设备的物理属性进行了抽象，并定义了逻辑存储单元，即文件<br>多用户访问文件时，需要控制权限问题</font>

##### IO子系统

<img src="md_image\image-20220604170909121.png" alt="image-20220604170909121" style="zoom:67%;" />

缓冲是为了传输，缓存是为了快速读取

#### 其他计算机系统

<font color=red> 客户机计算 web计算存在瓶颈？ 解决：负载平衡器 </font>

## OS结构

#### 系统调用

<font color=red>程序通过**应用程序接口(API)**访问，而不是直接使用系统调用</font>

sys call：昂贵且系统独立；api：简单且可移植

**系统设计**：系统设计受到硬件选择和系统类型的影响

**系统程序**：系统程序不属于内核，但属于操作系统的一部分

内核：**接口和驱动程序，硬件之上和系统调用接口下的所有部分**，包括文件系统、CPU调度、内存管理和其他操作系统功能

**微内核** ：缺点：用户空间和内核空间通信的系统开销增加

**模块结构**：大多数现代操作系统的结构，使用面向对象方法